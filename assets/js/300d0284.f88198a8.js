(self.webpackChunkhhow_09_github_io=self.webpackChunkhhow_09_github_io||[]).push([[7520],{3905:function(e,t,n){"use strict";n.d(t,{Zo:function(){return c},kt:function(){return d}});var r=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var s=r.createContext({}),p=function(e){var t=r.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=p(e.components);return r.createElement(s.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,a=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),m=p(n),d=o,k=m["".concat(s,".").concat(d)]||m[d]||u[d]||a;return n?r.createElement(k,i(i({ref:t},c),{},{components:n})):r.createElement(k,i({ref:t},c))}));function d(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=n.length,i=new Array(a);i[0]=m;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:o,i[1]=l;for(var p=2;p<a;p++)i[p]=n[p];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}m.displayName="MDXCreateElement"},2595:function(e,t,n){"use strict";n.r(t),n.d(t,{frontMatter:function(){return l},metadata:function(){return s},toc:function(){return p},default:function(){return u}});var r=n(2122),o=n(9756),a=(n(7294),n(3905)),i=["components"],l={},s={unversionedId:"web-dev/web-browser-event-loop",id:"web-dev/web-browser-event-loop",isDocsHomePage:!1,title:"Event Loop",description:"What is Event Loop",source:"@site/docs/web-dev/3-web-browser-event-loop.md",sourceDirName:"web-dev",slug:"/web-dev/web-browser-event-loop",permalink:"/web-dev/web-browser-event-loop",editUrl:"https://github.com/hhow09/hhow09.github.io/blob/source/docs/web-dev/3-web-browser-event-loop.md",version:"current",sidebarPosition:3,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Browser Navigation Flow",permalink:"/web-dev/web-browser-navigation-flow"},next:{title:"JS engine: Introduction",permalink:"/web-dev/web-js-engine-introduction"}},p=[{value:"What is Event Loop",id:"what-is-event-loop",children:[]},{value:"Concurrency Model and Event Loop",id:"concurrency-model-and-event-loop",children:[{value:"in Browser(Chrome)",id:"in-browserchrome",children:[]},{value:"in Node.js",id:"in-nodejs",children:[]}]},{value:"Terms",id:"terms",children:[{value:"libuv",id:"libuv",children:[]},{value:"I/O",id:"io",children:[]},{value:"Blocking v.s. Non-Blocking",id:"blocking-vs-non-blocking",children:[]},{value:"Events and event-driven programming",id:"events-and-event-driven-programming",children:[]},{value:"Task ( = <code>Macrotask</code>)",id:"task---macrotask",children:[]},{value:"Microtask",id:"microtask",children:[]},{value:"Tick",id:"tick",children:[]}]},{value:"Event Loop",id:"event-loop",children:[]},{value:"Reference",id:"reference",children:[]}],c={toc:p};function u(e){var t=e.components,l=(0,o.Z)(e,i);return(0,a.kt)("wrapper",(0,r.Z)({},c,l,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h2",{id:"what-is-event-loop"},"What is Event Loop"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Event loop is a programming construct or design pattern that waits for and dispatches events or messages in a program."),(0,a.kt)("li",{parentName:"ul"},"Event Loop responsible for ",(0,a.kt)("strong",{parentName:"li"},"executing the code"),", ",(0,a.kt)("strong",{parentName:"li"},"collecting and processing events"),", and ",(0,a.kt)("strong",{parentName:"li"},"executing queued sub-tasks"),"."),(0,a.kt)("li",{parentName:"ul"},"One of the important goal of event loop is provide ",(0,a.kt)("strong",{parentName:"li"},"non-blocking I/O operations")," for ",(0,a.kt)("strong",{parentName:"li"},"single-thread")," javascript engine."),(0,a.kt)("li",{parentName:"ul"},"How ",(0,a.kt)("inlineCode",{parentName:"li"},"libuv")," describe event loop",(0,a.kt)("blockquote",{parentName:"li"},(0,a.kt)("p",{parentName:"blockquote"},"In event-driven programming, an application expresses interest in certain events and respond to them when they occur. The responsibility of gathering events from the operating system or monitoring other sources of events is handled by libuv, and the user can register callbacks to be invoked when an event occurs. The event-loop usually keeps running forever."),(0,a.kt)("ul",{parentName:"blockquote"},(0,a.kt)("li",{parentName:"ul"},"In pseudocode:",(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre"},"e = get the next event\nif there is a callback associated with e:\ncall the callback\n")))))),(0,a.kt)("li",{parentName:"ul"},"Event loop in ",(0,a.kt)("inlineCode",{parentName:"li"},"browser")," or ",(0,a.kt)("inlineCode",{parentName:"li"},"Node.js")," ",(0,a.kt)("strong",{parentName:"li"},"is not part of the JS Engine (runtime)"),".")),(0,a.kt)("h2",{id:"concurrency-model-and-event-loop"},"Concurrency Model and Event Loop"),(0,a.kt)("h3",{id:"in-browserchrome"},"in Browser(Chrome)"),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"Chrome Event Loop",src:n(9876).Z})),(0,a.kt)("h3",{id:"in-nodejs"},"in Node.js"),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"Node.js Event Loop",src:n(6857).Z})),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"While Nodejs uses the Google V8 as it's ",(0,a.kt)("strong",{parentName:"li"},"runtime"),", it does not used V8 to implement the ",(0,a.kt)("strong",{parentName:"li"},"event loop"),"."),(0,a.kt)("li",{parentName:"ul"},"Nodejs uses the ",(0,a.kt)("strong",{parentName:"li"},"Libuv")," library (written in C) to implement the event loop.")),(0,a.kt)("h2",{id:"terms"},"Terms"),(0,a.kt)("h3",{id:"libuv"},(0,a.kt)("a",{parentName:"h3",href:"https://github.com/libuv/libuv"},"libuv")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"libuv is a multi-platform support library with a focus on asynchronous I/O.")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"It was primarily developed for use by Node.js")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"libuv enforces an ",(0,a.kt)("strong",{parentName:"p"},"asynchronous"),", ",(0,a.kt)("strong",{parentName:"p"},"event-driven")," style of programming.")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Its core job is to provide an ",(0,a.kt)("strong",{parentName:"p"},"event loop")," and ",(0,a.kt)("strong",{parentName:"p"},"callback based notifications of I/O")," and other activities.")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"libuv offers core utilities like ",(0,a.kt)("strong",{parentName:"p"},"timers"),", ",(0,a.kt)("strong",{parentName:"p"},"non-blocking networking support"),", ",(0,a.kt)("strong",{parentName:"p"},"asynchronous file system access"),", ",(0,a.kt)("strong",{parentName:"p"},"child processes")," and more.")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("a",{parentName:"p",href:"http://docs.libuv.org/en/v1.x/guide/basics.html"},"Basics of libuv")))),(0,a.kt)("h3",{id:"io"},"I/O"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Short for input/output, I/O refers primarily to the ",(0,a.kt)("strong",{parentName:"li"},"program\u2019s interaction with the system\u2019s disk and network"),"."),(0,a.kt)("li",{parentName:"ul"},"Examples of I/O operations include r",(0,a.kt)("strong",{parentName:"li"},"eading/writing data from/to a disk"),", ",(0,a.kt)("strong",{parentName:"li"},"making HTTP requests"),", and ",(0,a.kt)("strong",{parentName:"li"},"talking to databases"),"."),(0,a.kt)("li",{parentName:"ul"},"I/Os are very slow compared to ",(0,a.kt)("strong",{parentName:"li"},"accessing RAM")," or ",(0,a.kt)("strong",{parentName:"li"},"doing work on the CPU"),".")),(0,a.kt)("h3",{id:"blocking-vs-non-blocking"},"Blocking v.s. Non-Blocking"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Blocking is when the execution of additional JavaScript in the Node.js process ",(0,a.kt)("strong",{parentName:"li"},"must wait until a non-JavaScript operation completes"),"."),(0,a.kt)("li",{parentName:"ul"},"Blocking happens because the event loop is unable to continue running JavaScript while a blocking operation is occurring."),(0,a.kt)("li",{parentName:"ul"},"In Node.js, non-blocking primarily refers to ",(0,a.kt)("strong",{parentName:"li"},"I/O operations")),(0,a.kt)("li",{parentName:"ul"},"All of the I/O methods in the Node.js standard library provide async versions."),(0,a.kt)("li",{parentName:"ul"},"Blocking methods execute ",(0,a.kt)("strong",{parentName:"li"},"synchronously")," and non-blocking methods execute ",(0,a.kt)("strong",{parentName:"li"},"asynchronously"),".")),(0,a.kt)("h3",{id:"events-and-event-driven-programming"},"Events and event-driven programming"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Events")," are actions generated by the user or the system, like a click, a completed file download, or a hardware or software error."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Event-driven programming")," is a programming paradigm in which the ",(0,a.kt)("strong",{parentName:"li"},"flow of the program is determined by events"),"."),(0,a.kt)("li",{parentName:"ul"},"An event-driven program performs actions in response to events. When an event occurs it triggers a callback function.")),(0,a.kt)("h3",{id:"task---macrotask"},"Task ( = ",(0,a.kt)("inlineCode",{parentName:"h3"},"Macrotask"),")"),(0,a.kt)("h4",{id:"generic-task-sources"},(0,a.kt)("a",{parentName:"h4",href:"https://html.spec.whatwg.org/multipage/webappapis.html#generic-task-sources"},"Generic task sources")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"DOM manipulation/parsing"),(0,a.kt)("li",{parentName:"ul"},"User Interaction: keyboard or mouse input"),(0,a.kt)("li",{parentName:"ul"},"Network activity"),(0,a.kt)("li",{parentName:"ul"},"history traversal\uff1a ",(0,a.kt)("inlineCode",{parentName:"li"},"history.back()")," API")),(0,a.kt)("h3",{id:"microtask"},"Microtask"),(0,a.kt)("p",null,"A ",(0,a.kt)("inlineCode",{parentName:"p"},"microtask")," is a short function which ",(0,a.kt)("strong",{parentName:"p"},"is executed after the function or program which created it exits and only if the JavaScript execution stack is empty, but before returning control to the event loop being used by the user agent to drive the script's execution environment"),"."),(0,a.kt)("h3",{id:"tick"},"Tick"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"a complete process of ",(0,a.kt)("inlineCode",{parentName:"li"},"one event loop")," including:",(0,a.kt)("ol",{parentName:"li"},(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("inlineCode",{parentName:"li"},"dequeuing")," of an event from the ",(0,a.kt)("inlineCode",{parentName:"li"},"event loop queue")),(0,a.kt)("li",{parentName:"ol"},"the execution of said event.")))),(0,a.kt)("hr",null),(0,a.kt)("h2",{id:"event-loop"},"Event Loop"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"macrotask should be processed from the macrotask queue in one tick of the event loop. After this macrotask has finished, all other available microtasks should be processed within the same tick.")),(0,a.kt)("p",null,"//TODO"),(0,a.kt)("hr",null),(0,a.kt)("h2",{id:"reference"},"Reference"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://developer.mozilla.org/en-US/docs/Web/API/HTML_DOM_API/Microtask_guide"},"Using microtasks in JavaScript with queueMicrotask()")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://dev.to/khaosdoctor/node-js-under-the-hood-3-deep-dive-into-the-event-loop-135d"},"Node.js Under The Hood #3 - Deep Dive Into the Event Loop")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://nodejs.org/en/docs/guides/blocking-vs-non-blocking/"},"Node.js Overview of Blocking vs Non-Blocking")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"http://docs.libuv.org/en/v1.x/guide/basics.html"},"Basics of libuv")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://www.freecodecamp.org/news/node-js-what-when-where-why-how-ab8424886e2/"},"Node.js: what it is, when and how to use it, and why you should")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/EventLoop#run-to-completion"},"MDN: Concurrency model and the event loop")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://yeefun.github.io/event-loop-in-depth/?fbclid=IwAR0zHuodyFada1gfYL2P6CJjbHzxgX8KMAaUAlTsewERngKbswrf0guC-zU"},"\u6211\u77e5\u9053\u4f60\u61c2 Event Loop\uff0c\u4f46\u4f60\u4e86\u89e3\u5230\u591a\u6df1\uff1f")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://medium.com/infinitegamer/why-event-loop-exist-e8ac9d287044"},"\u3010\u7b46\u8a18\u3011\u5230\u5e95 Event Loop \u95dc\u6211\u5565\u4e8b\uff1f"))))}u.isMDXComponent=!0},9876:function(e,t,n){"use strict";t.Z=n.p+"assets/images/chrome-event-loop-ff8cd0def3c2feb790a62774dcf48f3b.png"},6857:function(e,t,n){"use strict";t.Z=n.p+"assets/images/nodejs-event-loop-978215883e4ad21debde58f8ca8746f9.png"}}]);