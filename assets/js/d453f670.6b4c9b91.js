(self.webpackChunkhhow_09_github_io=self.webpackChunkhhow_09_github_io||[]).push([[78],{3905:function(e,t,n){"use strict";n.d(t,{Zo:function(){return s},kt:function(){return d}});var o=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var i=o.createContext({}),u=function(e){var t=o.useContext(i),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},s=function(e){var t=u(e.components);return o.createElement(i.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},m=o.forwardRef((function(e,t){var n=e.components,r=e.mdxType,a=e.originalType,i=e.parentName,s=p(e,["components","mdxType","originalType","parentName"]),m=u(n),d=r,h=m["".concat(i,".").concat(d)]||m[d]||c[d]||a;return n?o.createElement(h,l(l({ref:t},s),{},{components:n})):o.createElement(h,l({ref:t},s))}));function d(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var a=n.length,l=new Array(a);l[0]=m;var p={};for(var i in t)hasOwnProperty.call(t,i)&&(p[i]=t[i]);p.originalType=e,p.mdxType="string"==typeof e?e:r,l[1]=p;for(var u=2;u<a;u++)l[u]=n[u];return o.createElement.apply(null,l)}return o.createElement.apply(null,n)}m.displayName="MDXCreateElement"},3819:function(e,t,n){"use strict";n.r(t),n.d(t,{frontMatter:function(){return p},metadata:function(){return i},toc:function(){return u},default:function(){return c}});var o=n(2122),r=n(9756),a=(n(7294),n(3905)),l=["components"],p={sidebar_position:2},i={unversionedId:"react/react-compund-component",id:"react/react-compund-component",isDocsHomePage:!1,title:"Compound Component",description:"Intro",source:"@site/docs/react/2-react-compund-component.md",sourceDirName:"react",slug:"/react/react-compund-component",permalink:"/docs/react/react-compund-component",editUrl:"https://github.com/facebook/docusaurus/edit/master/website/docs/react/2-react-compund-component.md",version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"tutorialSidebar",previous:{title:"Props Drilling and State Management",permalink:"/docs/react/react-prop-drilling"},next:{title:"3 Ways To Pass Values From Child to Parent",permalink:"/docs/react/react-parent-child-pass-value"}},u=[{value:"Intro",id:"intro",children:[]},{value:"What is Compound Component?",id:"what-is-compound-component",children:[]},{value:"Compound Component \u5be6\u4f5c: PopupFilter",id:"compound-component-\u5be6\u4f5c-popupfilter",children:[]},{value:"\u72c0\u614b\u7ba1\u7406 State Management",id:"\u72c0\u614b\u7ba1\u7406-state-management",children:[{value:"1. \u628a state \u90fd\u653e\u5728\u9801\u9762\u7d44\u4ef6\u88e1",id:"1-\u628a-state-\u90fd\u653e\u5728\u9801\u9762\u7d44\u4ef6\u88e1",children:[]},{value:"\u5be6\u969b\u4f7f\u7528",id:"\u5be6\u969b\u4f7f\u7528",children:[]}]},{value:"Reference",id:"reference",children:[]}],s={toc:u};function c(e){var t=e.components,n=(0,r.Z)(e,l);return(0,a.kt)("wrapper",(0,o.Z)({},s,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h2",{id:"intro"},"Intro"),(0,a.kt)("p",null,"\u771f\u5be6\u5de5\u4f5c\u4e0a\u9047\u5230\u7684\u554f\u984c\uff0c\u7236\u7d44\u4ef6\u662f\u4e00\u500b ",(0,a.kt)("inlineCode",{parentName:"p"},"Filter")," \uff0c\u5167\u90e8\u5b50\u7d44\u4ef6\u4f9d\u4e0d\u540c\u60c5\u6cc1\u6703\u6709\u4e0d\u540c\u6578\u91cf\u7684 Input / Select / Radio / CheckBox\uff0c\u4e26\u4e14\u7236\u7d44\u4ef6\u8981\u80fd\u63a7\u5236\u5b50\u7d44\u4ef6\u7684\u5167\u5bb9(ex.\u91cd\u8a2d\u7b49\u7b49)\uff0c\u539f\u672c\u7684\u540c\u4e8b\u662f\u5229\u7528 props \u50b3\u5165 array \u53bb\u6c7a\u5b9a render \u4ec0\u9ebc\u5167\u5bb9\uff0c\u4f46\u9019\u7a2e\u65b9\u6cd5\u4e00\u4f86\u5728\u95b1\u8b80\u4e0a\u6709\u56f0\u96e3\uff0c\u4e8c\u4f86\u6703\u9020\u6210 props \u9019\u689d\u8def\u5f91\u540c\u6642\u4e58\u8f09 UI \u5167\u5bb9\u548c\u8cc7\u6599\u5167\u5bb9\uff0c\u9019\u6a23\u5176\u5be6\u6578\u91cf\u591a\u8d77\u4f86\u95b1\u8b80\u6703\u5f88\u6df7\u4e82\uff0c\u958b\u59cb\u601d\u8003\u8981\u5982\u4f55\u8a2d\u8a08\u66f4\u597d\u3002"),(0,a.kt)("h2",{id:"what-is-compound-component"},"What is Compound Component?"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"Compound components is a pattern where components are used together such that they share an implicit state that lets them communicate with each other in the background. A compound component is composed of a subset of child components that all work in tandem to produce some functionality.")),(0,a.kt)("p",null,"Compound component \u7684\u76ee\u7684\u662f\u63d0\u4f9b\u4e00\u500b\u66f4\u5177\u8868\u73fe\u529b\u548c\u9748\u6d3b\u7684 API\uff0c\u63d0\u4f9b\u4e86\u4e00\u7a2e\u8868\u9054\u7d44\u4ef6\u4e4b\u9593\u95dc\u4fc2\u7684\u597d\u65b9\u6cd5\u3002\n\u767d\u8a71\u4e00\u9ede\u4f86\u8aaa\uff0c\u4e5f\u662f\u904b\u7528\u5230",(0,a.kt)("inlineCode",{parentName:"p"},"props.children"),"\uff0c\u7236\u7d44\u4ef6\u53ea\u8981\u9810\u8a2d\u597d\u5b50\u7d44\u4ef6\u6709\u54ea\u4e9b(\u751a\u81f3\u4e0d\u7528)\uff0c\u7236\u7d44\u4ef6\u4e0d\u9700\u8981\u660e\u78ba\u7684\u8868\u9054\u5b50\u7d44\u4ef6\u7684\u5167\u5bb9\u3002\u800c\u662f\u4f7f\u7528\u6642\uff0c\u4f9d\u4e0d\u540c\u60c5\u5883\u53bb\u5f15\u5165 chidren \u7684\u5167\u5bb9\u5373\u53ef\u3002"),(0,a.kt)("p",null,"\u5be6\u969b\u4e0a\u6709\u540d\u7684 ",(0,a.kt)("a",{parentName:"p",href:"https://material-ui.com/guides/composition/"},"Material UI"),"\u548c ",(0,a.kt)("a",{parentName:"p",href:"https://react.semantic-ui.com/modules/modal/#types-modal"},"Semantic UI"),"\u4e5f\u90fd\u63a1\u7528\u4e86\u9019\u7a2e UI \u8a2d\u8a08\u65b9\u6cd5\u3002"),(0,a.kt)("p",null,"\u9019\u500b\u6559\u5b78",(0,a.kt)("a",{parentName:"p",href:"https://kentcdodds.com/blog/compound-components-with-react-hooks"},"React Hooks: Compound Components"),"\u4ecb\u7d39\u4e86\u57fa\u672c\u7684 Compound Component \u8a2d\u8a08\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-jsx"},"    <Toggle onToggle={on => console.log(on)}>\n      <Toggle.On>The button is on</Toggle.On>\n      <Toggle.Off>The button is off</Toggle.Off>\n      <Toggle.Button />\n    </Toggle>\n")),(0,a.kt)("h2",{id:"compound-component-\u5be6\u4f5c-popupfilter"},"Compound Component \u5be6\u4f5c: PopupFilter"),(0,a.kt)("p",null,"\u73fe\u5728\u6211\u5011\u8981\u5efa\u7acb\u4e00\u500b PopupFilter \u6709\u4ee5\u4e0b\u9700\u6c42\u3002"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u6211\u5011\u53ef\u4ee5\u5728\u4e0d\u540c\u60c5\u6cc1\u4e0b\u589e\u6e1b\u5b50\u7d44\u4ef6\u3002"),(0,a.kt)("li",{parentName:"ul"},"\u6bcf\u500b\u5b50\u7d44\u4ef6\u90fd\u6709\u81ea\u5df1\u7684\u72c0\u614b\u3002"),(0,a.kt)("li",{parentName:"ul"},"\u8981\u80fd\u5920\u53d6\u5f97/\u7ba1\u7406\u5b50\u7d44\u4ef6\u7684\u72c0\u614b\uff08defaultValue, reset, submit)\u3002")),(0,a.kt)("p",null,"\u6a94\u6848\u7d50\u69cb\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"|\u2500\u2500 PopupFilter\n    \u251c\u2500\u2500 index.js\n    \u251c\u2500\u2500 components\n        \u251c\u2500\u2500 Header\n        \u2514\u2500\u2500 Footer\n        \u2514\u2500\u2500 DateRange\n        \u2514\u2500\u2500 Select\n        \u2514\u2500\u2500 Checkboxes\n        \u2514\u2500\u2500 index.js\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-jsx"},"// PopupFilter/index.js\nimport React from 'react';\nimport { Popper, Grow } from '@material-ui/core';\nimport { ClickAwayListener } from '@material-ui/core';\nimport {Header,Select,DateRange,Checkboxes,Footer} from './components';\n\nconst PopupFilter = ({ open, anchorEl, children, onClose }) => {\n  return (\n    <Popper\n      open={open}\n      anchorEl={anchorEl}\n      transition\n    >\n    <div>{children}</div>\n    </Popper>\n  );\n};\n\nPopupFilter.Header = Header;\nPopupFilter.Footer = Footer;\nPopupFilter.Select = Select;\nPopupFilter.DateRange = DateRange;\nPopupFilter.Checkboxes = Checkboxes;\n\nexport default PopupFilter;\n\n//Page.js\nconst Page=()=>{\n  const [open,setOpen]=React.useState(false);\n  const handleClose=()=>setOpen(false);\n  return(\n<PopupFilter open={open} onClose={handleClose}>\n    <PopupFilter.Header />\n    <PopupFilter.Checkboxes label={'CheckBox'} options={...} />\n    // ...\n    <PopupFilter.Select label={'Select1'} options={...} />\n    <PopupFilter.Select label={'Select2'} options={...} />\n    <PopupFilter.DateRange label={'DateRange'} />\n    <PopupFilter.Footer />\n    <OtherChildren/>\n</PopupFilter>)\n}\n")),(0,a.kt)("p",null,"\u597d\u4e86\uff0c\u770b\u8d77\u4f86\u5176\u5be6\u5f88\u7c21\u55ae\uff0c\u4e5f\u662f\u4f7f\u7528\u5230 children\uff0c\u8b93\u4e0d\u540c\u4f7f\u7528\u60c5\u5883\u81ea\u884c\u589e\u6e1b\uff0c\u4f46\u76ee\u524d\u90fd\u9084\u6c92\u6709\u8003\u616e\u5230\u72c0\u614b\u7ba1\u7406\u7684\u554f\u984c\u3002"),(0,a.kt)("h2",{id:"\u72c0\u614b\u7ba1\u7406-state-management"},"\u72c0\u614b\u7ba1\u7406 State Management"),(0,a.kt)("p",null,"\u73fe\u5728\uff0c\u5b50\u7d44\u4ef6\u4e26\u672a\u53d7\u5230\u7236\u7d44\u4ef6\u63a7\u5236\u3002 \u6211\u5011\u8981\u5982\u4f55\u7ba1\u7406\u5b50\u7d44\u4ef6\u7684 state\uff08ex. defaultValue\uff0chandleChange\uff0chandleReset\uff0cgetResult ...\uff09\uff1f\u56e0\u70ba\u9019\u7a2e\u505a\u6cd5\u7236\u7d44\u4ef6\u4e0d\u6703",(0,a.kt)("strong",{parentName:"p"},"\u63d0\u524d"),"\u77e5\u9053\u5b50\u7d44\u4ef6\u6709\u4ec0\u9ebc\u5167\u5bb9\uff0c\u6240\u4ee5\u4e5f\u7121\u6cd5",(0,a.kt)("strong",{parentName:"p"},"\u9810\u8a2d"),"\u6709\u591a\u5c11\u500b\u5b50\u7d44\u4ef6\u7684 state \u8981\u7ba1\u7406\u3002\u5176\u5be6\u662f\u6bd4\u7236\u7d44\u4ef6\u66f4\u4e0a\u5c64\u7684\u9801\u9762\u7d44\u4ef6\u624d\u6703\u77e5\u9053\u7576\u4e0b\u5b50\u7d44\u4ef6\u6709\u591a\u5c11\u500b\u3002"),(0,a.kt)("h3",{id:"1-\u628a-state-\u90fd\u653e\u5728\u9801\u9762\u7d44\u4ef6\u88e1"},"1. \u628a state \u90fd\u653e\u5728\u9801\u9762\u7d44\u4ef6\u88e1"),(0,a.kt)("p",null,"\u9019\u662f\u6700\u76f4\u89ba\u7684\uff0clift state up\uff0c\u4f46\u662f\u7576\u7d44\u4ef6\u589e\u52a0\u6642\u9801\u9762\u5c31\u6703\u8b8a\u5f97\u6df7\u4e82\u3002\u7d50\u679c\u5c07\u6703\u51fa\u73fe\u4e00\u5806\u72c0\u614b\u548c handleChange\u3002"),(0,a.kt)("h4",{id:"2-custom-hook"},"2. Custom hook"),(0,a.kt)("p",null,"\u5c07 state / update/ reset \u7684\u908f\u8f2f\u653e\u5728 hook \u88e1\uff0c\u6211\u5011\u5c07\u5176\u7a31\u70ba usePopupFilter\u3002\n\u90a3\u56de\u5230\u525b\u525b\u7684\u554f\u984c\uff0c\u8981\u5982\u4f55",(0,a.kt)("strong",{parentName:"p"},"\u52d5\u614b\u7684"),"\u5e6b\u5b50\u7d44\u4ef6\u5efa\u7acb state \u5462\uff1f\u6211\u5011\u53ef\u4ee5\u8b93 usePopupFilter return \u4e00\u500b ",(0,a.kt)("inlineCode",{parentName:"p"},"register")," \u7684\u65b9\u6cd5 \b\uff0c\u6bcf\u500b\u9700\u8981\u63a7\u5236\u72c0\u614b\u7684\u5b50\u7d44\u4ef6\u63d0\u4f9b\u4e0d\u91cd\u8907\u7684 key\uff0c\u4f7f\u7528 register \u4f86",(0,a.kt)("strong",{parentName:"p"},"\u8a3b\u518a"),"\u81ea\u5df1\u5728 state \u4e2d\u7684\u4f4d\u7f6e\u3002\n\u5728\u9801\u9762\u4e2d\uff0c\u6211\u5011\u53ea\u662f",(0,a.kt)("strong",{parentName:"p"},"\u4f7f\u7528 custom hook \u53d6\u5f97\u7d50\u679c\u7684\u6700\u65b0\u72c0\u614b"),"\uff0c\u4fdd\u6301\u9801\u9762\u7684\u7c21\u6f54\u548c\u53ef\u8b80\u6027\uff0c\u65e2\u512a\u96c5\u53c8\u7c21\u6f54\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-jsx"},"//usePopupFilter.js\nimport {useState, useEffect, useCallback } from 'react';\nimport { useImmer } from 'use-immer';\n\nconst usePopupFilter = ({ defaultValue }) => {\n  const [state, setState] = useState({ data: { ...defaultValue } });\n  const { data } = state;\n\n  //\u63d0\u4f9b\u5b50\u7d44\u4ef6\u300c\u8a3b\u518a\u300d\u4e00\u500bstate Object\u7684key\u6b04\u4f4d\uff0c\u4e26\u56de\u50b3\u5b50\u7d44\u4ef6\u9700\u8981\u7684prop\n  const register = useCallback(\n    key => ({\n      value: data[key],\n      defaultValue: defaultValue[key],\n      onChange: value => setState(state => (state.data[key] = value)),\n    }),\n    [data]\n  );\n\n  //\u63d0\u4f9bonSubmit\u50b3\u5165\u4e26\u8b80\u53d6data\n  const handleSubmit = useCallback(\n    onSubmit => () => {\n      onSubmit(data);\n    },\n    [data]\n  );\n\n  const reset = useCallback(() => {\n    setState(state => (state.data = defaultValue));\n  }, []);\n\n  return { state, register, handleSubmit, reset };\n};\n\nexport default usePopupFilter;\n\n")),(0,a.kt)("h3",{id:"\u5be6\u969b\u4f7f\u7528"},"\u5be6\u969b\u4f7f\u7528"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-jsx"},"import React, { useState, useEffect } from 'react';\nimport PopupFilter from './PopupFilter';\nimport usePopupFilter from 'Hooks/usePopupFilter';\n\nexport const PopupFilterDemo = () => {\n  const [open, setOpen] = useState(false);\n\n  const { state, register, handleSubmit, reset } = usePopupFilter({\n    defaultValue: {\n      checkbox: [options1[1]],\n    },\n    ...\n  });\n\n  const handleOpen = () => {\n    setOpen(!open);\n  };\n\n  const handleClose = () => setOpen(false);\n\n  const onFilter = data => {\n    handleClose();\n    handleSubmit_();\n  };\n  const handleSubmit_=()=>{\n    ...\n  }\n  return (\n    <div >\n        <button onClick={handleOpen}>OpenFilter</button>\n        <PopupFilter open={open} onClose={handleClose}>\n          <PopupFilter.Header onClick={reset} />\n          <PopupFilter.Checkboxes\n            label={'CheckBox'}\n            options={options1}\n            {...register('checkbox')}\n          />\n          <PopupFilter.Select\n            label={'Select'}\n            options={options2}\n            {...register('select')}\n          />\n          <PopupFilter.Select\n            label={'Select2'}\n            options={options2}\n            {...register('select2')}\n          />\n          <PopupFilter.DateRange label={'DateRange'} {...register('DateRange')} />\n          <PopupFilter.Footer onClick={handleSubmit(onFilter)} />\n        </PopupFilter>\n    </div>\n  );\n};\nconst options1 = [\n  { value: '1', label: 'option1' },\n  { value: '2', label: 'option2' },\n  { value: '3', label: 'option3' },\n];\n\nconst options2 = [\n  { value: '1', label: 'select1' },\n  { value: '2', label: 'select2' },\n  { value: '3', label: 'select3' },\n];\n")),(0,a.kt)("h2",{id:"reference"},"Reference"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://kentcdodds.com/blog/compound-components-with-react-hooks"},"React Hooks: Compound Components")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://medium.com/better-programming/mastering-the-compound-component-pattern-cd0e56937fc3"},"Master the Compound Component Pattern")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://reactjs.org/docs/hooks-custom.html"},"React.js Building Your Own Hooks"))))}c.isMDXComponent=!0}}]);