<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.0">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Modern Tragedy Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Modern Tragedy Blog Atom Feed"><title data-react-helmet="true">Node.js Event Loop | Modern Tragedy</title><meta data-react-helmet="true" property="og:url" content="https://hhow09.github.io//programming/js-event-loop"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Node.js Event Loop | Modern Tragedy"><meta data-react-helmet="true" name="description" content="What is Event Loop"><meta data-react-helmet="true" property="og:description" content="What is Event Loop"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://hhow09.github.io//programming/js-event-loop"><link data-react-helmet="true" rel="alternate" href="https://hhow09.github.io//programming/js-event-loop" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://hhow09.github.io//programming/js-event-loop" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.cb17f33c.css">
<link rel="preload" href="/assets/js/runtime~main.78349e0e.js" as="script">
<link rel="preload" href="/assets/js/main.f9761070.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">Modern Tragedy</strong></a><a class="navbar__item navbar__link navbar__link--active" href="/">Docs</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/hhow09" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle displayOnlyInLargeViewport_GrZ2 react-toggle--disabled" role="button" tabindex="-1"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_71bT">🌜</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">🌞</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input type="search" id="search_input_react" placeholder="Search" aria-label="Search" class="navbar__search-input search-bar"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">Modern Tragedy</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link navbar__link--active" href="/">Docs</a></li><li class="menu__list-item"><a class="menu__link" href="/blog">Blog</a></li><li class="menu__list-item"><a href="https://github.com/hhow09" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><div class="docSidebarContainer_3Kbt" role="complementary"><div class="sidebar_15mo"><div class="menu menu--responsive thin-scrollbar menu_Bmed"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/">Index</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Algorithm</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/algorithm/union-find">Union Find</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/algorithm/prefix-sum">Prefix Sum</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/algorithm/leetcode-474-ones-and-zeroes">474. Ones and Zeroes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/algorithm/leetcode-698-partition-to-k-equal-sum-subsets">698. Partition to K Equal Sum Subsets</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Data Structure</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/data-structure/index">Index</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/data-structure/skip-list">Skip List</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/data-structure/b-tree">B-Tree</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/data-structure/lsm-tree">LSM Tree</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Database</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/db/dynamodb-modeling">How to model one-to-many relationships in DynamoDB</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/db/transaction-phenomena">Transaction Phenomenas</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Infrastructure</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/infra/kustomization-helm-migration">Kustomization to Helm 3 Migration</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Programming</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/programming/clean-code-note">Clean Code - Object Oriented Design</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/programming/concurrent-vs-parallelism">Concurrency vs. Parallelism v.s. Coroutine</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/programming/memory-allocations-golang">Understanding Memory Allocations in Go</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/programming/js-closure">Closure</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/programming/js-immutability">Immutability</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/programming/js-fp">Functional Programming</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/programming/js-dev-note">Javascript Dev Notes</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/programming/js-event-loop">Node.js Event Loop</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">React</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/react/react-prop-drilling">Props Drilling and State Management</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/react/react-compund-component">Compound Component</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/react/react-parent-child-pass-value">3 Ways To Pass Values From Child to Parent</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/react/react-dev-detail">React Dev Notes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/react/react-interview-questions">React Interview Questions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/react/redux-flux">Redux and Flux</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/react/react-performance-optimization">Performance Optimization of React</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Web Dev</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/web-dev/web-lighthouse-performance">Lighthouse Performance / Frontend Performance</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/web-dev/web-browser-navigation-flow">Browser Navigation Flow</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/web-dev/web-js-engine-introduction">JS engine: Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/web-dev/web-js-engine-object-optimization">JS engine: Optimizing of Object</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/web-dev/web-auth">Web Authentication</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/web-dev/webpack-overview">Webpack Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/web-dev/ssr-stream">Node.js Streaming Server-Side Rendering</a></li></ul></li></ul></div></div></div><main class="docMainContainer_3ufF"><div class="container padding-vert--lg docItemWrapper_3FMP"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><header><h1 class="docTitle_3a4h">Node.js Event Loop</h1></header><div class="markdown"><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="what-is-event-loop"></a>What is Event Loop<a class="hash-link" href="#what-is-event-loop" title="Direct link to heading">#</a></h2><ul><li>Event loop is a programming construct or design pattern that waits for and dispatches events or messages in a program.</li><li>Event Loop responsible for <strong>scheduling code executions</strong>, <strong>collecting and processing events</strong>, and <strong>scheduling queued sub-tasks</strong>.</li><li>One of the important goal of event loop is provide <strong>non-blocking I/O operations</strong> for <strong>single-thread</strong> javascript engine.</li><li>How <code>libuv</code> describe event loop<blockquote><p>In event-driven programming, an application expresses interest in certain events and respond to them when they occur. The responsibility of gathering events from the operating system or monitoring other sources of events is handled by libuv, and the user can register callbacks to be invoked when an event occurs. The event-loop usually keeps running forever.</p><ul><li>In pseudocode:<div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">e = get the next event</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">if there is a callback associated with e:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">call the callback</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></li></ul></blockquote></li><li>Event loop in <code>browser</code> or <code>Node.js</code> <strong>is not part of the JS Engine (runtime)</strong>.</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="concurrency-model-and-event-loop"></a>Concurrency Model and Event Loop<a class="hash-link" href="#concurrency-model-and-event-loop" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="in-browserchrome"></a>in Browser(Chrome)<a class="hash-link" href="#in-browserchrome" title="Direct link to heading">#</a></h3><p><img alt="Chrome Event Loop" src="/assets/images/chrome-event-loop-ff8cd0def3c2feb790a62774dcf48f3b.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="in-nodejs"></a>in Node.js<a class="hash-link" href="#in-nodejs" title="Direct link to heading">#</a></h3><p><img alt="Node.js Event Loop" src="/assets/images/nodejs-event-loop-978215883e4ad21debde58f8ca8746f9.png"></p><ul><li>While Nodejs uses the Google V8 as it&#x27;s <strong>runtime</strong>, it does not used V8 to implement the <strong>event loop</strong>.</li><li>Nodejs uses the <strong>Libuv</strong> library (written in C) to implement the event loop.</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="terms-of-architecture--concept"></a>Terms: of architecture &amp; concept<a class="hash-link" href="#terms-of-architecture--concept" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="libuv"></a><a href="https://github.com/libuv/libuv" target="_blank" rel="noopener noreferrer">libuv</a><a class="hash-link" href="#libuv" title="Direct link to heading">#</a></h3><ul><li><p>libuv is a multi-platform support library with a focus on asynchronous I/O.</p></li><li><p>It was primarily developed for use by Node.js</p></li><li><p>libuv enforces an <strong>asynchronous</strong>, <strong>event-driven</strong> style of programming.</p></li><li><p>Its core job is to provide an <strong>event loop</strong> and <strong>callback based notifications of I/O</strong> and other activities.</p></li><li><p>libuv offers core utilities like <strong>timers</strong>, <strong>non-blocking networking support</strong>, <strong>asynchronous file system access</strong>, <strong>child processes</strong> and more.</p></li><li><p>ref: <a href="http://docs.libuv.org/en/v1.x/guide/basics.html" target="_blank" rel="noopener noreferrer">Basics of libuv</a></p></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="io"></a>I/O<a class="hash-link" href="#io" title="Direct link to heading">#</a></h3><ul><li>Short for input/output, I/O refers primarily to the <strong>program’s interaction with the system’s disk and network</strong>.</li><li>Examples of I/O operations include <strong>reading/writing data from/to a disk</strong> (<code>fs.readfileSync()</code>), <strong>making HTTP requests</strong>, and <strong>talking to databases</strong>.</li><li>I/Os are very slow compared to <strong>accessing RAM</strong> or <strong>doing work on the CPU</strong>.</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="blocking-vs-non-blocking"></a>Blocking v.s. Non-Blocking<a class="hash-link" href="#blocking-vs-non-blocking" title="Direct link to heading">#</a></h3><ul><li>Blocking is when the execution of additional JavaScript in the Node.js process <strong>must wait until a non-JavaScript operation completes</strong>.</li><li>Blocking happens because the event loop is unable to continue running JavaScript while a blocking operation is occurring.</li><li>In Node.js, non-blocking primarily refers to <strong>I/O operations</strong></li><li>All of the I/O methods in the Node.js standard library provide async versions.</li><li>Blocking methods execute <strong>synchronously</strong> and non-blocking methods execute <strong>asynchronously</strong>.</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="events-and-event-driven-programming"></a>Events and event-driven programming<a class="hash-link" href="#events-and-event-driven-programming" title="Direct link to heading">#</a></h3><ul><li><strong>Events</strong> are actions generated by the user or the system, like a click, a completed file download, or a hardware or software error.</li><li><strong>Event-driven programming</strong> is a programming paradigm in which the <strong>flow of the program is determined by events</strong>.</li><li>An event-driven program performs actions in response to events. When an event occurs it triggers a callback function.</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="thread-pool--is-nodejs-single-thread"></a>Thread Pool &amp; Is Node.js Single Thread?<a class="hash-link" href="#thread-pool--is-nodejs-single-thread" title="Direct link to heading">#</a></h3><ul><li>in general code in Node.js is running with single thread developer cannot spawn a new thread (exception: <a href="https://nodejs.org/api/worker_threads.html#worker_threads_class_worker" target="_blank" rel="noopener noreferrer">worker thread</a>, and <a href="https://nodejs.org/api/child_process.html#child_process_child_process" target="_blank" rel="noopener noreferrer">child_process</a>)</li><li>I/Os, file system operations are <strong>multi-threaded</strong> (not part of the JS code).</li><li>libuv / Node.js provides a <a href="http://docs.libuv.org/en/v1.x/threadpool.html" target="_blank" rel="noopener noreferrer">threadpool</a> of <strong>default size 4</strong>.</li><li>New updates of Node.js offers <a href="https://www.npmjs.com/package/workerpool" target="_blank" rel="noopener noreferrer">workerpool</a> to create threads easily.</li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><div tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> crypto </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">require</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;crypto&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">const</span><span class="token plain"> start </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token known-class-name class-name" style="color:rgb(255, 203, 107)">Date</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">now</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">//crypto.pbkdf2 is running in thread pool</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">logHashTime</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  crypto</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">pbkdf2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;a&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;b&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">100000</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">512</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;sha512&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token console class-name" style="color:rgb(255, 203, 107)">console</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">log</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Hash: &quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token known-class-name class-name" style="color:rgb(255, 203, 107)">Date</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">now</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token plain"> start</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// default size of thread pool is 4</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// first 4 will be execute in parallel (almost same time)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">logHashTime</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">logHashTime</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">logHashTime</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">logHashTime</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 5th one will be execute later.</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">logHashTime</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><ul><li>ref: <a href="https://blog.logrocket.com/node-js-multithreading-what-are-worker-threads-and-why-do-they-matter-48ab102f8b10/" target="_blank" rel="noopener noreferrer">Node.js multithreading: What are Worker threads, and why do they matter?</a></li></ul><hr><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="terms-of-tasks"></a>Terms of Tasks<a class="hash-link" href="#terms-of-tasks" title="Direct link to heading">#</a></h2><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Priority of execution</h5></div><div class="admonition-content"><p>Sync &gt; Nanotask &gt; Microtask &gt; Task / Macrotask</p></div></div><ul><li>Note: <code>nanotask</code> only exists in Node.js</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="task---macrotask"></a>Task ( = <code>Macrotask</code>)<a class="hash-link" href="#task---macrotask" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="generic-task-sources"></a><a href="https://html.spec.whatwg.org/multipage/webappapis.html#generic-task-sources" target="_blank" rel="noopener noreferrer">Generic task sources</a><a class="hash-link" href="#generic-task-sources" title="Direct link to heading">#</a></h4><ul><li>DOM manipulation/parsing</li><li>User Interaction: keyboard or mouse input</li><li>Network activity: <code>fetch</code>, <code>XMLHttpRequest</code></li><li>history traversal: <code>history.back()</code></li><li>Web APIs: <code>setTimeout</code>, <code>setInterval</code>, <code>setImmediate</code>(legacy), <code>requestAnimationFrame</code>, <code>I/O</code>, <code>UI rendering</code></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="microtask"></a>Microtask<a class="hash-link" href="#microtask" title="Direct link to heading">#</a></h3><ul><li><code>microtask</code> is a short function which <strong>is executed after the function or program which created it exits and only if the JavaScript execution stack is empty, but before returning control to the event loop being used by the user agent to drive the script&#x27;s execution environment</strong>.</li><li>microtasks can queue other microtasks, while there are microtasks in the microtask queue, they should all be run one by one until the microtask queue is empty.</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="example-of-microtask"></a>Example of Microtask<a class="hash-link" href="#example-of-microtask" title="Direct link to heading">#</a></h4><ul><li><code>Promise</code>, <code>Promise.then</code></li><li><code>process.nextTick</code></li><li><code>Object.observe</code></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="tick"></a>Tick<a class="hash-link" href="#tick" title="Direct link to heading">#</a></h3><ul><li>a complete process of <code>one event loop</code> including:<ol><li><code>dequeuing</code> of an event from the <code>event loop queue</code></li><li>the execution of said event.</li></ol></li></ul><hr><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="event-loop-in-nodejs"></a>Event Loop in Node.js<a class="hash-link" href="#event-loop-in-nodejs" title="Direct link to heading">#</a></h2><blockquote><p>macrotask should be processed from the macrotask queue in one tick of the event loop. After this macrotask has finished, all other available microtasks should be processed within the same tick.</p></blockquote><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">   ┌───────────────────────────┐</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">┌─&gt;│           timers          │</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">│  └─────────────┬─────────────┘</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">│  ┌─────────────┴─────────────┐</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">│  │     pending callbacks     │</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">│  └─────────────┬─────────────┘</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">│  ┌─────────────┴─────────────┐</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">│  │       idle, prepare       │</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">│  └─────────────┬─────────────┘      ┌───────────────┐</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">│  ┌─────────────┴─────────────┐      │   incoming:   │</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">│  │           poll            │&lt;─────┤  connections, │</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">│  └─────────────┬─────────────┘      │   data, etc.  │</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">│  ┌─────────────┴─────────────┐      └───────────────┘</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">│  │           check           │</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">│  └─────────────┬─────────────┘</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">│  ┌─────────────┴─────────────┐</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">└──┤      close callbacks      │</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   └───────────────────────────┘</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>//TODO</p><hr><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="reference"></a>Reference<a class="hash-link" href="#reference" title="Direct link to heading">#</a></h2><ul><li><p><a href="https://developer.mozilla.org/en-US/docs/Web/API/HTML_DOM_API/Microtask_guide" target="_blank" rel="noopener noreferrer">Using microtasks in JavaScript with queueMicrotask()</a></p></li><li><p><a href="https://dev.to/khaosdoctor/node-js-under-the-hood-3-deep-dive-into-the-event-loop-135d" target="_blank" rel="noopener noreferrer">Node.js Under The Hood #3 - Deep Dive Into the Event Loop</a></p></li><li><p><a href="https://nodejs.org/en/docs/guides/blocking-vs-non-blocking/" target="_blank" rel="noopener noreferrer">Node.js: Overview of Blocking vs Non-Blocking</a></p></li><li><p><a href="http://docs.libuv.org/en/v1.x/guide/basics.html" target="_blank" rel="noopener noreferrer">libuv: Basics of libuv</a></p></li><li><p><a href="https://www.freecodecamp.org/news/node-js-what-when-where-why-how-ab8424886e2/" target="_blank" rel="noopener noreferrer">Node.js: what it is, when and how to use it, and why you should</a></p></li><li><p><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/EventLoop#run-to-completion" target="_blank" rel="noopener noreferrer">MDN: Concurrency model and the event loop</a></p></li><li><p><a href="https://pjchender.dev/javascript/note-event-loop-microtask/" target="_blank" rel="noopener noreferrer">PJChenDer: [Note] Event loop, micro-task, macro-task, async JavaScript 筆記</a></p></li><li><p><a href="https://yeefun.github.io/event-loop-in-depth/?fbclid=IwAR0zHuodyFada1gfYL2P6CJjbHzxgX8KMAaUAlTsewERngKbswrf0guC-zU" target="_blank" rel="noopener noreferrer">我知道你懂 Event Loop，但你了解到多深？</a></p></li><li><p><a href="https://medium.com/infinitegamer/why-event-loop-exist-e8ac9d287044" target="_blank" rel="noopener noreferrer">【筆記】到底 Event Loop 關我啥事？</a></p></li></ul></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/hhow09/hhow09.github.io/blob/source/docs/programming/15-js-event-loop.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-label="Edit page"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/programming/js-dev-note"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« Javascript Dev Notes</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/react/react-prop-drilling"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Props Drilling and State Management »</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#what-is-event-loop" class="table-of-contents__link">What is Event Loop</a></li><li><a href="#concurrency-model-and-event-loop" class="table-of-contents__link">Concurrency Model and Event Loop</a><ul><li><a href="#in-browserchrome" class="table-of-contents__link">in Browser(Chrome)</a></li><li><a href="#in-nodejs" class="table-of-contents__link">in Node.js</a></li></ul></li><li><a href="#terms-of-architecture--concept" class="table-of-contents__link">Terms: of architecture &amp; concept</a><ul><li><a href="#libuv" class="table-of-contents__link">libuv</a></li><li><a href="#io" class="table-of-contents__link">I/O</a></li><li><a href="#blocking-vs-non-blocking" class="table-of-contents__link">Blocking v.s. Non-Blocking</a></li><li><a href="#events-and-event-driven-programming" class="table-of-contents__link">Events and event-driven programming</a></li><li><a href="#thread-pool--is-nodejs-single-thread" class="table-of-contents__link">Thread Pool &amp; Is Node.js Single Thread?</a></li></ul></li><li><a href="#terms-of-tasks" class="table-of-contents__link">Terms of Tasks</a><ul><li><a href="#task---macrotask" class="table-of-contents__link">Task ( = <code>Macrotask</code>)</a></li><li><a href="#microtask" class="table-of-contents__link">Microtask</a></li><li><a href="#tick" class="table-of-contents__link">Tick</a></li></ul></li><li><a href="#event-loop-in-nodejs" class="table-of-contents__link">Event Loop in Node.js</a></li><li><a href="#reference" class="table-of-contents__link">Reference</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/">Docs</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://github.com/hhow09" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github</a></li><li class="footer__item"><a href="https://www.linkedin.com/in/hhow09" target="_blank" rel="noopener noreferrer" class="footer__link-item">Linkedin</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 hhow09, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.78349e0e.js"></script>
<script src="/assets/js/main.f9761070.js"></script>
</body>
</html>